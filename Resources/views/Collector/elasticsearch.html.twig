{% extends 'WebProfilerBundle:Profiler:layout.html.twig' %}

{% block toolbar %}
    {% set icon %}
    {% if profiler_markup_version == 2 %}
        <img width="20" height="28" alt="Elasticsearch" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAZCAMAAAAVHr4VAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAVNQTFRFAAAAdLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/////4SvSgAAAAG90Uk5TAAAEAQILhNqsEAMf9v5gNS0FZfioBtBWEen98iA++m1p/ME6e+vFKzDo++AWomxvpvmDTEAbEpXY3r73ross24bXzbYjlL2tCjtVeJtI9GYINzyIFfDOCYrhDhTEZwciSZ+JkQyY0fP1MT/CanFw5iQhUAAAAAFiS0dEcNgAbHQAAAAJcEhZcwAACxMAAAsTAQCanBgAAAGYSURBVCjPbVLpX1MxEOy8pIqxAeqzHlFbH4JIEaRylMOjCkUEjwIqRQ4vUEFg/v9vblJaefycD0k2s7Ob3U0m0wYEkVKyZs5CbK2hkL1wseuS7OdJwGhczll2w6Sl4tzTizyuMOZVFFKRve4ar+PGTTreui2JO6SPiDtksXSXibB997JQ/3SqgH4WnRugwDreH4RGO2GEB0O0NmFAmcMP0Q4shxHaIAqk4yiMMkZ7B+hHdK6lYmI9O+bLCWqUWLFtTigr62OMT0xmPTlVbaWzct81TZcUOTPLOT6ByWgMin9SLiesPH028NyrHeOYVWh5kKm98NGGX7I6Np9fqC+6Sky+8k32/Vl6vbzy5m12mu9m3zegVnvX1ruVRiCN76YU/qH+kfw0hWCGDoeDMVFktFYbTXIdBW+i0/4wNBXlUaPd/Hx+akIXGtjalndzB7uN9H8wWB768vVbrfn9x+he3z6is6TC0k9WfuVyud9zjA86c2mF1Tj80zw6Pjk+qm+XoFNh5T2dOZ3Wkf6BvgKBjOs//zMFf/cXzV5N9jbVTdkAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTQtMTItMTlUMTA6NDY6MTUtMDU6MDAyC+pAAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTEyLTE5VDEwOjQ2OjE1LTA1OjAwQ1ZS/AAAAABJRU5ErkJggg=="/>
    {% else %}
        <img width="20" height="28" alt="Elasticsearch" style="border-width: 0; vertical-align: middle; margin-right: 5px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAZCAMAAAAVHr4VAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAVNQTFRFAAAAdLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/////4SvSgAAAAG90Uk5TAAAEAQILhNqsEAMf9v5gNS0FZfioBtBWEen98iA++m1p/ME6e+vFKzDo++AWomxvpvmDTEAbEpXY3r73ross24bXzbYjlL2tCjtVeJtI9GYINzyIFfDOCYrhDhTEZwciSZ+JkQyY0fP1MT/CanFw5iQhUAAAAAFiS0dEcNgAbHQAAAAJcEhZcwAACxMAAAsTAQCanBgAAAGYSURBVCjPbVLpX1MxEOy8pIqxAeqzHlFbH4JIEaRylMOjCkUEjwIqRQ4vUEFg/v9vblJaefycD0k2s7Ob3U0m0wYEkVKyZs5CbK2hkL1wseuS7OdJwGhczll2w6Sl4tzTizyuMOZVFFKRve4ar+PGTTreui2JO6SPiDtksXSXibB997JQ/3SqgH4WnRugwDreH4RGO2GEB0O0NmFAmcMP0Q4shxHaIAqk4yiMMkZ7B+hHdK6lYmI9O+bLCWqUWLFtTigr62OMT0xmPTlVbaWzct81TZcUOTPLOT6ByWgMin9SLiesPH028NyrHeOYVWh5kKm98NGGX7I6Np9fqC+6Sky+8k32/Vl6vbzy5m12mu9m3zegVnvX1ruVRiCN76YU/qH+kfw0hWCGDoeDMVFktFYbTXIdBW+i0/4wNBXlUaPd/Hx+akIXGtjalndzB7uN9H8wWB768vVbrfn9x+he3z6is6TC0k9WfuVyud9zjA86c2mF1Tj80zw6Pjk+qm+XoFNh5T2dOZ3Wkf6BvgKBjOs//zMFf/cXzV5N9jbVTdkAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTQtMTItMTlUMTA6NDY6MTUtMDU6MDAyC+pAAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTEyLTE5VDEwOjQ2OjE1LTA1OjAwQ1ZS/AAAAABJRU5ErkJggg=="/>
    {% endif %}
    {% if profiler_markup_version == 2 %}
        <span class="sf-toolbar-value">{{ collector.count }}</span>
    {% else %}
        <span class="sf-toolbar-status{% if collector.count %} sf-toolbar-status-green{% endif %}">{{ collector.count }}</span>
    {% endif %}

    {% endset %}
    {% set text %}
    <div class="sf-toolbar-info-piece">
        <b>Queries</b>
        <span{% if profiler_markup_version == 2 %} class="sf-toolbar-status"{% endif %}>{{ collector.count }}</span>
    </div>
    <div class="sf-toolbar-info-piece">
        <b>Query time</b>
        <span>{{ '%0.2f'|format(collector.timetaken) }} ms</span>
    </div>
    <div class="sf-toolbar-info-piece">
        <b>Response Size</b>
        <span>{{ collector.getTotalResponseSize() }}</span>
    </div>
    {% endset %}
    {% include 'WebProfilerBundle:Profiler:toolbar_item.html.twig' with { 'link': profiler_url } %}
{% endblock %}

{% block menu %}
    <span class="label">
    <span class="icon"><img width="28" alt="Elasticsearch" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAZCAMAAAAVHr4VAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAVNQTFRFAAAAdLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/dLc/////4SvSgAAAAG90Uk5TAAAEAQILhNqsEAMf9v5gNS0FZfioBtBWEen98iA++m1p/ME6e+vFKzDo++AWomxvpvmDTEAbEpXY3r73ross24bXzbYjlL2tCjtVeJtI9GYINzyIFfDOCYrhDhTEZwciSZ+JkQyY0fP1MT/CanFw5iQhUAAAAAFiS0dEcNgAbHQAAAAJcEhZcwAACxMAAAsTAQCanBgAAAGYSURBVCjPbVLpX1MxEOy8pIqxAeqzHlFbH4JIEaRylMOjCkUEjwIqRQ4vUEFg/v9vblJaefycD0k2s7Ob3U0m0wYEkVKyZs5CbK2hkL1wseuS7OdJwGhczll2w6Sl4tzTizyuMOZVFFKRve4ar+PGTTreui2JO6SPiDtksXSXibB997JQ/3SqgH4WnRugwDreH4RGO2GEB0O0NmFAmcMP0Q4shxHaIAqk4yiMMkZ7B+hHdK6lYmI9O+bLCWqUWLFtTigr62OMT0xmPTlVbaWzct81TZcUOTPLOT6ByWgMin9SLiesPH028NyrHeOYVWh5kKm98NGGX7I6Np9fqC+6Sky+8k32/Vl6vbzy5m12mu9m3zegVnvX1ruVRiCN76YU/qH+kfw0hWCGDoeDMVFktFYbTXIdBW+i0/4wNBXlUaPd/Hx+akIXGtjalndzB7uN9H8wWB768vVbrfn9x+he3z6is6TC0k9WfuVyud9zjA86c2mF1Tj80zw6Pjk+qm+XoFNh5T2dOZ3Wkf6BvgKBjOs//zMFf/cXzV5N9jbVTdkAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTQtMTItMTlUMTA6NDY6MTUtMDU6MDAyC+pAAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTEyLTE5VDEwOjQ2OjE1LTA1OjAwQ1ZS/AAAAABJRU5ErkJggg=="/></span>
    <strong>Elasticsearch</strong>
    <span class="count">
        <span>{{ collector.count }}</span>
        <span>{{ '%0.0f'|format(collector.timetaken) }} ms</span>
    </span>
</span>
{% endblock %}

{% block panel %}

    <h2>Queries</h2>

    {% if not collector.count %}
        <p><em>No queries.</em></p>
    {% else %}
        <table>
            <thead>
            <tr>
                <th>#</th>
                <th>Status</th>
                <th>Time</th>
                <th>Size</th>
                <th>Method</th>
                <th>Index</th>
                <th>Type</th>
                <th>Action</th>
                <th>RequestBody</th>
                <th>Response</th>
                <th>Class Info</th>
                <th>Config</th>
            </tr>
            </thead>
            <tbody>

            {% for key, query in collector.data %}
                <tr>
                    <td width="10">{{ key }}</td>
                    <td width="10"{% if "error" ==  query.status %} style="color: red;"{% endif %}>{{ query.status }}</td>
                    <td>{{ '%0.2f'|format(query.timeTaken) }} ms</td>
                    <td>{{ query.responseSize }}</td>
                    {#<td>{{ query.requestClass }}</td>#}
                    <td>{{ query.method }}</td>
                    <td>{{ query.index }}</td>
                    <td>{{ query.type }}</td>
                    <td>{{ query.action }}</td>
                    {#<td>{{ query.responseClass }}</td>#}
                    <td>
                        {% if query.bodyRaw and query.body is defined %}
                            <a href="#" title="show raw request body" onclick="ElastificationProfilerJs.toggle('es-request-body-raw-{{ key }}')">Raw</a>
                            | <a href="#" title="show nice formatted request body" onclick="ElastificationProfilerJs.toggle('es-request-body-nice-{{ key }}')">Nice</a>
                        {% endif %}
                    </td>
                    <td>
                        {% if query.response is defined %}
                            <a href="#" title="show raw response" onclick="ElastificationProfilerJs.toggle('es-response-raw-{{ key }}')">Raw</a>
                            | <a href="#" title="show nice formatted response" onclick="ElastificationProfilerJs.toggle('es-response-nice-{{ key }}')">Nice</a>
                        {% endif %}
                    </td>
                    <td>
                        <a href="#" title="show used classes" onclick="ElastificationProfilerJs.toggle('es-class-info-{{ key }}')">Show</a>
                    </td>
                    <td>
                        <a href="#" title="show Bundle config" onclick="ElastificationProfilerJs.toggle('es-config-{{ key }}')">Show</a>
                    </td>
                </tr>

                <tr id="es-class-info-{{ key }}" style="display: none;">
                    <td colspan="2">Classes Used</td>
                    <td colspan="10">
                        <p>Request: {{ query.requestClass }}</p>
                        <p>Response: {{ query.responseClass }}</p>
                    </td>
                </tr>

                <tr id="es-config-{{ key }}" style="display: none;">
                    <td colspan="2">Bundle Config</td>
                    <td colspan="10">{{ dump(query.config) }}</td>
                </tr>

                {% if query.bodyRaw and query.body is defined %}
                    <tr id="es-request-body-raw-{{ key }}" style="display: none;">
                        <td colspan="2">Raw Request Body</td>
                        <td colspan="10">{{ query.bodyRaw }}</td>
                    </tr>
                    <tr id="es-request-body-nice-{{ key }}" style="display: none;">
                        <td>Formatted Request Body</td>
                        <td colspan="10">{{ dump(query.body) }}</td>
                    </tr>
                {% endif %}


                {% if query.response is defined %}
                    <tr id="es-response-raw-{{ key }}" style="display: none;">
                        <td colspan="2">Raw Response</td>
                        <td colspan="10">{{ query.responseRaw }}</td>
                    </tr>
                    <tr id="es-response-nice-{{ key }}" style="display: none;">
                        <td colspan="2">Formatted Response</td>
                        <td colspan="10">{{ dump(query.response) }}</td>
                    </tr>
                {% endif %}

            {% endfor %}
            </tbody>
        </table>
    {% endif %}

    <script>/*<![CDATA[*/
        ElastificationProfilerJs = (function() {
            "use strict";

            return {
                toggle: function(elementId) {
                    var el = document.getElementById(elementId);

                    if('none' == el.style.display) {
                        el.style.display = null;
                    } else {
                        el.style.display = 'none';
                    }

                    return this;
                }
            };
        })();
    /*]]>*/</script>

{% endblock %}